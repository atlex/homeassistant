- id: bathroom_hum_above
  alias: bathroom_hum_above
  trigger: 
    - platform: numeric_state # OR
      entity_id: sensor.bathroom_temp_humidity #Bathroom
      above: 70
    - platform: numeric_state # OR
      entity_id: sensor.bathroom2_temp_humidity #Bathroom2
      above: 70
  action:
    - service: switch.turn_on
      entity_id: switch.sonoff_1000b6d861
    - delay: 00:00:03
    - service: notify.Telegram
      data_template:
        message: "Bathroom humidity {{ states('sensor.bathroom_temp_humidity') }}% / {{ states('sensor.bathroom2_temp_humidity') }}%. Fan is {{ states('switch.sonoff_1000b6d861') }}."

- id: bathroom_hum_below
  alias: bathroom_hum_below
  trigger:
    - platform: numeric_state
      entity_id: sensor.bathroom_temp_humidity #Bathroom
      below: 60
    - platform: numeric_state
      entity_id: sensor.bathroom2_temp_humidity #Bathroom2
      below: 60
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: switch.sonoff_1000b6d861
        state: "on"
      - condition: numeric_state
        entity_id: sensor.bathroom_temp_humidity #Bathroom
        below: 60
      - condition: numeric_state
        entity_id: sensor.bathroom2_temp_humidity #Bathroom2
        below: 60
  action:
    - service: switch.turn_off
      entity_id: switch.sonoff_1000b6d861
    - delay: 00:00:03
    - service: notify.Telegram
      data_template:
        message: "Bathroom humidity {{ states('sensor.bathroom_temp_humidity') }}% / {{ states('sensor.bathroom2_temp_humidity') }}%. Fan is {{ states('switch.sonoff_1000b6d861') }}."
            
- id: bathroom_fan_button
  alias: bathroom_fan_button
  trigger:
  - platform: event
    event_type: xiaomi_aqara.click
    event_data:
      entity_id: binary_sensor.switch_158d0001b195a0
      click_type: single
  action:
    - service: switch.toggle
      entity_id: switch.sonoff_1000b6d861
    - delay: 00:00:03
    - service: notify.Telegram
      data_template:
        message: "Bathroom Fan is {{ states('switch.sonoff_1000b6d861') }}."

# Water leak        
- id: bathroom_water_leak_on
  alias: bathroom_water_leak_on
  trigger:
  - platform: state
    entity_id: binary_sensor.bathroom_water_leak_water_leak
    from: "off"
    to: "on"
  action:
    - service: light.turn_on
      entity_id: light.gateway_light_34ce008141db
      data:
        color_name: red
    - service: notify.Telegram
      data_template:
        #message: "Bathroom Water leak is {{ states('binary_sensor.lumi_lumi_sensor_wleak_aq1_d1f39b04_ias_zone') }}."
        message: "WARNING! Water in the Bathroom!"

- id: bathroom_water_leak_off
  alias: bathroom_water_leak_off
  trigger:
  - platform: state
    entity_id: binary_sensor.bathroom_water_leak_water_leak
    from: "on"
    to: "off"
  action:
    - service: light.turn_off
      entity_id: light.gateway_light_34ce008141db
    - service: notify.Telegram
      data_template:
        #message: "Bathroom Water leak is {{ states('binary_sensor.lumi_lumi_sensor_wleak_aq1_d1f39b04_ias_zone') }}."
        message: "No Water in the Bathroom."

